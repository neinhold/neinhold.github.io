(this.webpackJsonphax=this.webpackJsonphax||[]).push([[0],{23:function(e,a,t){e.exports=t.p+"static/media/hax_big.b0ca6dfe.svg"},41:function(e,a,t){e.exports=t(78)},46:function(e,a,t){},72:function(e,a,t){},78:function(e,a,t){"use strict";t.r(a);var s=t(0),n=t.n(s),l=t(20),i=t.n(l),r=(t(46),t(40)),o=t(12),c=t(22),m=t(13),u=t(14),d=t(9),h=t(16),p=t(15),f=t(23),v=t.n(f),y=t(8),g=t.n(y),E=t(6),b=t(24),N=t.n(b),k=t(18),w=t.n(k),S=(t(69),t(37)),C=t.n(S),T=(t(71),t(72),"https://lively-scene-db1a.neinhold.workers.dev/?http://85.159.209.166.nip.io/"),I="http://www.haxball.com/replay?v=3#http://85.159.209.166/replays/",A=function(e){Object(h.a)(t,e);var a=Object(p.a)(t);function t(e){var s;Object(m.a)(this,t),(s=a.call(this,e)).state={curlink:"",stats:[],replayInfo:[],chatLogs:[],chatLog:[],playerClicked:{},playerTabs:{},playerHeatmaps:{},playerHeatmapsLoaded:{},playerHeatmapsMaxvalue:{},selectedStat:{value:"totalmatchcount",label:"Games Played"},hideplayerstats:!0,replaydisplaycount:50};var n=(new Date).getTime();return g.a.get(T+"data/url.txt?timestamp="+n).then((function(e){var a=e.data;s.state.curlink=a,s.setState({curlink:s.state.curlink})})),s.getJsonl("data/stats"),s.getJsonl("data/replayInfo"),g.a.get(T+"chatlogs/").then((function(e){var a=e.data;a=(a=a.sort()).reverse(),s.state.chatLogs=a,s.setState({curlink:s.state.curlink})})),s.updateDimensions=s.updateDimensions.bind(Object(d.a)(s)),s.componentDidMount=s.componentDidMount.bind(Object(d.a)(s)),s.onSelect=s.onSelect.bind(Object(d.a)(s)),s}return Object(u.a)(t,[{key:"getJsonl",value:function(e){var a=this,t=T+e+".jsonl";g.a.get(t).then((function(t){var s=[t.data];if("string"===typeof t.data&&(s=P(t.data)),"data/stats"==e){s.sort(a.sortByProperty("totalmatchcount")),a.state.stats=s;for(var n=0;n<a.state.stats.length;n++)a.calculatePlayerStats(a.state.stats[n])}"data/replayInfo"==e&&(s.sort(a.sortByProperty("id")),a.state.replayInfo=s),e.includes("chatlogs/")&&(a.state.chatLog=s),a.setState({curlink:a.state.curlink})}))}},{key:"msToString",value:function(e){var a=Math.floor(e/1e3),t=Math.floor(a/3600),s=Math.floor((a-3600*t)/60);return t+"h"+s+"m"+(a-3600*t-60*s)+"s"}},{key:"msToElapsedSince",value:function(e){var a=new Date(parseInt(e)),t=new Date,s=Math.floor((t-a)/864e5),n=a.toISOString().substring(0,10),l=s+" days ago";return 1!=s&&0!=s||(l="1 day ago"),t.toISOString().substring(0,10)==n&&(l="Today"),0==e&&(l="n/a"),l}},{key:"sortByProperty",value:function(e){return function(a,t){var s=parseFloat(a[e]),n=parseFloat(t[e]);return s<n?1:s>n?-1:0}}},{key:"playerClicked",value:function(e){this.state.playerClicked[e]=!this.state.playerClicked[e],this.state.playerTabs[e]=0,this.state.playerHeatmapsLoaded[e]=!1,this.setState({playerClicked:this.state.playerClicked})}},{key:"tabClicked",value:function(e,a){this.state.playerTabs[e]=a,this.state.playerHeatmapsLoaded[e]=!1,this.setState({playerTabs:this.state.playerTabs})}},{key:"renderTabs",value:function(e){var a=this,t=["Tab Tri","Tab Tri","Tab Tri"];return t[this.state.playerTabs[e]]+=" Selected",n.a.createElement("div",null,n.a.createElement("div",{onClick:function(){return a.tabClicked(e,0)},className:t[0]},"Stats"),n.a.createElement("div",{onClick:function(){return a.tabClicked(e,1)},className:t[1]},"More"),n.a.createElement("div",{onClick:function(){return a.tabClicked(e,2)},className:t[2]},"Heatmap"))}},{key:"renderHeatmap",value:function(e,a){return n.a.createElement("div",{className:"HeatmapContainer"},n.a.createElement("div",{style:{height:133},className:"Heatmap"+a}))}},{key:"loadHeatmap",value:function(e,a){var t=this,s=T+"heatmaps/players/"+e+".json";g.a.get(s).then((function(e){var s=[e.data];s=s[0];for(var n={heatmap:[],visible:!0},l=1,i=0,r=0;r<s.length;r++)for(var o=0;o<s[r].length;o++){var c={x:6.5*r,y:3.7666*o,value:s[r][o]+1};n.heatmap.push(c),i+=c.value,c.value>l&&(l=c.value)}t.state.playerHeatmaps[a]=n,l=i/(s.length*s[0].length)*3,t.state.playerHeatmapsMaxvalue[a]=l,t.setState({playerHeatmaps:t.state.playerHeatmaps})}))}},{key:"generateHeatMap",value:function(e,a){var t=this.state.playerHeatmaps[a].heatmap,s=N.a.create({container:document.querySelector(".Heatmap"+e),radius:8,maxOpacity:.5,minOpacity:0,blur:.75}),n={min:1,max:this.state.playerHeatmapsMaxvalue[a],data:t};s.setData(n)}},{key:"kFormatter",value:function(e){return Math.abs(e)>999?Math.sign(e)*(Math.abs(e)/1e3).toFixed(1)+"k":Math.sign(e)*Math.abs(e)}},{key:"calculatePlayerStats",value:function(e){e.cleansheetrate=parseInt(Math.floor(100*(e.gkcleansheetcount/e.gkmatchcount).toFixed(2))||0),e.winrate1v1=parseInt(Math.floor(100*(e.total1v1wincount/e.total1v1count).toFixed(2))||0),e.distancepergame=parseInt(e.totaldistancecovered/e.stats2matchcount||0),e.concededpergame=e.gkconcededcount/e.gkmatchcount||0,e.winrate=parseInt(Math.floor(100*(e.totalwincount/e.totalmatchcount).toFixed(2))||0),e.lossrate=parseInt(Math.floor(100*(e.totallosscount/e.totalmatchcount).toFixed(2))||0),e.goalspergame=e.totalscorecount/e.totalmatchcount||0,e.assistspergame=e.totalassistcount/e.totalmatchcount||0,e.scorerpointspergame=parseFloat(e.goalspergame)+parseFloat(e.assistspergame);var a=Math.max(0,1-(e.concededpergame-.7)),t=Math.min(100,e.cleansheetrate+50*a),s=Math.min(1,Math.max(0,e.concededpergame-.5)/4.5),n=100-(Math.min(1,e.concededpergame)*(100-t)+t*s);e.defenserating=parseInt(n),e.gkmatchcount<20&&(e.defenserating=0);var l=e.scorerpointspergame+.5,i=Math.min(1,Math.max(0,l-1));l=Math.min(1,l);var r=.95*Math.min(1,e.scorerpointspergame/.95),o=(r+=.05*Math.max(0,e.scorerpointspergame-1))*l;o+=(1-o)*i,e.offenserating=parseInt(100*o),e.totalmatchcount<30&&(e.offenserating=0);var c=e.gkmatchcount/e.stats2matchcount;0==e.gkmatchcount&&(c=0),c/=.8;var m=e.winrate/100/.7/2+.6;m>1&&(m=1+.25*(1-(m-1))*(m-1));var u=e.defenserating*c;0==e.defenserating&&(u=0);var d=(u+e.offenserating*(1-c))*m;e.rating=parseInt(Math.min(100,d)),0==e.defenserating&&(e.rating=Math.max(0,e.rating-5))}},{key:"renderPlayerStats",value:function(e,a){var t=this;if("HOST_AUTH"==e.auth)return n.a.createElement("div",null);if(a in this.state.playerClicked||(this.state.playerClicked[a]=!1),0!=e.stats2matchcount&&!(this.state.hideplayerstats&&e.totalmatchcount<=50)){if(this.state.playerClicked[a]){if(1==this.state.playerTabs[a])return n.a.createElement("div",{className:"Container Click"},this.renderTabs(a),n.a.createElement("div",{onClick:function(){return t.playerClicked(a)}},n.a.createElement("div",{className:"InfoTitle"},e.lastname),n.a.createElement("div",{className:"PlayerStatsGames"},n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Offense Rating"),n.a.createElement("div",{className:"SmallDigit"},0==e.offenserating?"n/a":e.offenserating)),n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Rating"),n.a.createElement("div",{className:"BigDigit"},0==e.rating?"n/a":e.rating)),n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Defense Rating"),n.a.createElement("div",{className:"SmallDigit"},0==e.defenserating?"n/a":e.defenserating))),n.a.createElement("div",{className:"PlayerStatsGames"},n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Games as GK"),n.a.createElement("div",{className:"SmallDigit"},e.gkmatchcount),n.a.createElement("hr",null),n.a.createElement("div",{className:"SmallDigitSmall"},e.gkconcededcount),n.a.createElement("div",{className:"SubTitle"},"goals conceded")),n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Clean Sheets"),n.a.createElement("div",{className:"SmallDigit"},e.gkcleansheetcount),n.a.createElement("hr",null),n.a.createElement("div",{className:"SmallDigitSmall"},e.cleansheetrate+"%"),n.a.createElement("div",{className:"SubTitle"},"clean sheets"))),n.a.createElement("div",{className:"PlayerStatsGames"},n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"1v1s"),n.a.createElement("div",{className:"SmallDigit"},e.total1v1count),n.a.createElement("hr",null),n.a.createElement("div",{className:"SmallDigitSmall"},e.winrate1v1+"%"),n.a.createElement("div",{className:"SubTitle"},"won")),n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Distance"),n.a.createElement("div",{className:"SmallDigit"},this.kFormatter(e.totaldistancecovered)),n.a.createElement("hr",null),n.a.createElement("div",{className:"SmallDigitSmall"},e.distancepergame+"m"),n.a.createElement("div",{className:"SubTitle"},"per game")),n.a.createElement("div",{className:"PlayerStatsGames"},n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Hattricks"),n.a.createElement("div",{className:"SmallDigit"},e.hattrickcount)),n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"4 goals"),n.a.createElement("div",{className:"SmallDigit"},e.unstoppablecount)),n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"5 goals"),n.a.createElement("div",{className:"SmallDigit"},e.dominatingcount))))));if(2==this.state.playerTabs[a]){if(!this.state.playerHeatmaps[a])return this.loadHeatmap(e.auth,a),n.a.createElement("div",{className:"Container Click"},this.renderTabs(a),n.a.createElement("div",{onClick:function(){return t.playerClicked(a)}},n.a.createElement("div",{className:"InfoTitle"},e.lastname),n.a.createElement("div",{className:"Subtitle"},"No Heatmap available for this player.")));if(!this.state.playerHeatmapsLoaded[a]){var s=this;setTimeout((function(){s.generateHeatMap(e.auth,a),s.state.playerHeatmapsLoaded[a]=!0}),500)}return n.a.createElement("div",{className:"Container Click"},this.renderTabs(a),n.a.createElement("div",{onClick:function(){return t.playerClicked(a)}},n.a.createElement("div",{className:"InfoTitle"},e.lastname),n.a.createElement("div",{className:"Heatmap"},n.a.createElement("img",{className:"Stadium",src:v.a}),this.renderHeatmap(this.state.playerHeatmaps[a],e.auth))))}return n.a.createElement("div",{className:"Container Click"},this.renderTabs(a),n.a.createElement("div",{onClick:function(){return t.playerClicked(a)}},n.a.createElement("div",{className:"InfoTitle"},e.lastname),n.a.createElement("div",{className:"InfoPlainTitle"},"Games played"),n.a.createElement("div",{className:"BigDigit"},e.totalmatchcount),n.a.createElement("div",{className:"PlayerStatsGames"},n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Wins"),n.a.createElement("div",{className:"SmallDigit"},e.totalwincount),n.a.createElement("hr",null),n.a.createElement("div",{className:"SmallDigitSmall"},e.winrate+"%"),n.a.createElement("div",{className:"SubTitle"},"won")),n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Losses"),n.a.createElement("div",{className:"SmallDigit"},e.totallosscount),n.a.createElement("hr",null),n.a.createElement("div",{className:"SmallDigitSmall"},e.lossrate+"%"),n.a.createElement("div",{className:"SubTitle"},"lost")),n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Goals"),n.a.createElement("div",{className:"SmallDigit"},e.totalscorecount),n.a.createElement("hr",null),n.a.createElement("div",{className:"SmallDigitSmall"},e.goalspergame.toFixed(2)),n.a.createElement("div",{className:"SubTitle"},"per game")),n.a.createElement("div",{className:"InfoBox"},n.a.createElement("div",{className:"InfoPlainTitle"},"Assists"),n.a.createElement("div",{className:"SmallDigit"},e.totalassistcount),n.a.createElement("hr",null),n.a.createElement("div",{className:"SmallDigitSmall"},e.assistspergame.toFixed(2)),n.a.createElement("div",{className:"SubTitle"},"per game")),n.a.createElement("div",{className:"InfoPlainTitle"},"Total time played"),n.a.createElement("div",{className:"SmallDigit"},this.msToString(e.totalplaytime)),n.a.createElement("div",{className:"InfoPlainTitle"},"Last played"),n.a.createElement("div",{className:"SmallDigit"},this.msToElapsedSince(e.lastplayed)))))}var l=e[this.state.selectedStat.value];return l%1!=0&&(l=l.toFixed(2)),this.state.selectedStat.value.includes("rating")&&(l=0==l?"n/a":l),n.a.createElement("div",{onClick:function(){return t.playerClicked(a)},className:"Container Click"},n.a.createElement("div",{className:"TextLeft"},e.lastname),n.a.createElement("div",{className:"TextRight"},l))}}},{key:"goToReplay",value:function(e){var a=I+e+".hbr2";window.open(a,"_blank")}},{key:"renderDropDown",value:function(){var e=this.state.selectedStat;return n.a.createElement(C.a,{placeholderClassName:"DropDownPlaceholder",controlClassName:"DropDownControl",menuClassName:"DropDownMenu",options:[{value:"totalmatchcount",label:"Games Played"},{value:"rating",label:"Rating"},{value:"offenserating",label:"Offense Rating"},{value:"defenserating",label:"Defense Rating"},{value:"totalscorecount",label:"Goals"},{value:"totalassistcount",label:"Assists"},{value:"goalspergame",label:"Goals Per Game"},{value:"assistspergame",label:"Assists Per Game"},{value:"winrate",label:"Winrate"},{value:"gkmatchcount",label:"Games as GK"},{value:"gkcleansheetcount",label:"Clean Sheets"},{value:"concededpergame",label:"Goals Conceded Per Game"},{value:"cleansheetrate",label:"Clean Sheet Rate"},{value:"totaldistancecovered",label:"Distance"},{value:"distancepergame",label:"Distance Per Game"},{value:"hattrickcount",label:"Hattricks"},{value:"unstoppablecount",label:"4 goals"},{value:"dominatingcount",label:"5 goals"}],onChange:this.onSelect,value:e,placeholder:"Select an option"})}},{key:"onSelect",value:function(e){this.state.stats.sort(this.sortByProperty(e.value)),this.state.selectedStat=e,this.setState({stats:this.state.stats})}},{key:"onReplayInputChanged",value:function(e){var a,t=e.target.value.toLowerCase(),s=1,n=Object(c.a)(this.state.replayInfo);try{for(n.s();!(a=n.n()).done;){var l=a.value;this.doesArrayIncludeSubstring(l.blueplayers,t)||this.doesArrayIncludeSubstring(l.redplayers,t)||l.stadium.toLowerCase().includes(t)||l.id.toLowerCase().includes(t)||L(l.duration).includes(t)||l.scorered+":"+l.scoreblue==t||l.scorered+"-"+l.scoreblue==t?(l.result=s,s++):l.result=-1}}catch(i){n.e(i)}finally{n.f()}this.setState({replayInfo:this.state.replayInfo})}},{key:"doesArrayIncludeSubstring",value:function(e,a){var t,s=Object(c.a)(e);try{for(s.s();!(t=s.n()).done;){if(t.value.toLowerCase().includes(a))return!0}}catch(n){s.e(n)}finally{s.f()}return!1}},{key:"renderChatLog",value:function(e,a){var t=e.substring(0,e.length-6);return n.a.createElement("a",{href:t,target:"_blank"},n.a.createElement("div",{className:"Container Click"},n.a.createElement("div",{className:"SmallDigitSmall"},t)))}},{key:"componentDidMount",value:function(){this.updateDimensions(),window.addEventListener("resize",this.updateDimensions)}},{key:"updateDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"render",value:function(){var e=this,a=this.state.height-270;this.state.height<650&&(a="500px");var t="Show players with <50 games";return this.state.hideplayerstats||(t="Hide players with <50 games"),n.a.createElement("div",null,n.a.createElement(E.c,null,n.a.createElement(E.a,{exact:!0,path:"/"},n.a.createElement("div",{className:"App"},n.a.createElement("header",{className:"Header"},n.a.createElement("div",{className:"Title"},"/hax/"),n.a.createElement("a",{className:"RoomLink",href:this.state.curlink,target:"_blank",rel:"noopener noreferrer"},n.a.createElement("div",{className:"LinkContainer"},this.state.curlink)),n.a.createElement("div",{className:"InfoPlainTitle"},"or"),n.a.createElement("a",{className:"PlayLink",href:"https://neinhold.github.io/play",target:"_blank",rel:"noopener noreferrer"},n.a.createElement("div",{className:"LinkContainer Small"},"neinhold.github.io/play"))),n.a.createElement("div",{className:"Row",style:{height:a}},n.a.createElement("div",{className:"Column"},n.a.createElement("div",{className:"ColumnTitle"},"Chatlogs"),n.a.createElement(w.a,null,n.a.createElement("div",{className:"Column Chatlog"},this.state.chatLogs.map((function(a,t){return e.renderChatLog(a,t)}))))),n.a.createElement("div",{className:"Column"},n.a.createElement("div",{className:"ColumnTitle"},"Stats"),this.renderDropDown(),n.a.createElement(w.a,null,n.a.createElement("div",{className:"Column Stats"},this.state.stats.map((function(a,t){return e.renderPlayerStats(a,t)})),n.a.createElement("div",{onClick:function(){return e.setState({hideplayerstats:!e.state.hideplayerstats})},className:"Container Inline Click"},n.a.createElement("div",{className:"SmallDigitSmall"},t))))),n.a.createElement("div",{className:"Column"},n.a.createElement("div",{className:"ColumnTitle"},"Replays"),n.a.createElement("input",{onChange:function(a){return e.onReplayInputChanged(a)},type:"text",placeholder:"Search replays..."}),n.a.createElement(w.a,null,n.a.createElement("div",{className:"Column Replays"},this.state.replayInfo.map((function(a,t){return D(a,t,e.state.replaydisplaycount)})),n.a.createElement("div",{onClick:function(){return e.setState({replaydisplaycount:e.state.replaydisplaycount+50})},className:"Container Inline Click"},n.a.createElement("div",{className:"SmallDigitSmall"},"Show next 50 Replays")))))))),n.a.createElement(E.a,{exact:!0,path:"/:id",component:function(a){return n.a.createElement(x,{id:a.match.params,curlink:e.state.curlink,replayInfo:e.state.replayInfo,stats:e.state.stats})}}),n.a.createElement(E.a,{path:"/d/:id",component:function(e){return window.location="http://85.159.209.166/replays/"+R(e.match.params.id)+".hbr2",null}})))}}]),t}(n.a.Component),x=function(e){Object(h.a)(t,e);var a=Object(p.a)(t);function t(e){var s;Object(m.a)(this,t),(s=a.call(this,e)).state={chatLog:[],replayInfo:[],stats:[],isHelp:!1,analyticsstats:{}};var n=e.id.id,l=e.replayInfo;if(s.state.replayInfo=l,s.state.stats=e.stats,!isNaN(n)){var i=R(n);return window.location=I+i+".hbr2",Object(o.a)(s,null)}if("play"==n){if(e.curlink)return window.location=e.curlink,Object(o.a)(s,null)}else if("help"==n)s.state.isHelp=!0;else{var r=T+"chatlogs/"+n+".jsonl";g.a.get(r).then((function(e){var a=[e.data];"string"===typeof e.data&&(a=P(e.data)),s.state.chatLog=a,s.setState({chatLog:s.state.chatLog})}))}return s}return Object(u.a)(t,[{key:"analyzeChatLog",value:function(e){for(var a={},t=0;t<e.length;t++){var s=e[t];0==s.type&&(s.auth in this.state.analyticsstats?this.state.analyticsstats[s.auth].names.push(s.name):this.state.analyticsstats[s.auth]={names:[s.name],goals:0,assists:0,wins:0,matches:0,losses:0})}for(t=0;t<e.length;t++){var n=e[t];if(2==n.type&&n.message.includes("GOAL")&&!n.message.includes("OWN GOAL")){var l=n.message.indexOf("! "),i=n.message.indexOf(" scores"),r=n.message.substr(l+2,i-l-2);r in a||(a[r]={goals:0,assists:0}),a[r].goals+=1;var o=n.message.indexOf("assist from ");if(-1!=o){var c=n.message.substr(o+12);(c=c.substr(0,c.length-1))in a||(a[c]={goals:0,assists:0}),a[c].assists+=1}}if(3==n.type){var m=this.getReplayInfo(n.id);if(!m)break;if("redplayers"in m||(m.redplayers=[]),"blueplayers"in m||(m.blueplayers=[]),m.redplayers.length+m.blueplayers.length<6){for(var u in a){var d=this.checkForAuth(this.state.analyticsstats,u);null!=d&&(this.state.analyticsstats[d].goals+=a[u].goals,this.state.analyticsstats[d].assists+=a[u].assists)}if(m.scorered>m.scoreblue){for(var h=0;h<m.redplayers.length;h++){var p=this.checkForAuth(this.state.analyticsstats,m.redplayers[h]);null!=p&&(this.state.analyticsstats[p].wins+=1,this.state.analyticsstats[p].matches+=1)}for(var f=0;f<m.blueplayers.length;f++){var v=this.checkForAuth(this.state.analyticsstats,m.blueplayers[f]);null!=v&&(this.state.analyticsstats[v].losses+=1,this.state.analyticsstats[v].matches+=1)}}if(m.scorered<m.scoreblue){for(h=0;h<m.redplayers.length;h++){var y=this.checkForAuth(this.state.analyticsstats,m.redplayers[h]);null!=y&&(this.state.analyticsstats[y].losses+=1,this.state.analyticsstats[y].matches+=1)}for(f=0;f<m.blueplayers.length;f++){var g=this.checkForAuth(this.state.analyticsstats,m.blueplayers[f]);null!=g&&(this.state.analyticsstats[g].wins+=1,this.state.analyticsstats[g].matches+=1)}}}a={}}}console.log("STATS"),console.log(this.state.analyticsstats)}},{key:"fixStats",value:function(e){var a=Object(r.a)(this.state.stats);for(var t in console.log("FIX STATS - "+e),this.state.analyticsstats)for(e=0;e<a.length;e++){a[e].auth==t&&(a[e].newtotalscorecount=parseInt(a[e].totalscorecount)-this.state.analyticsstats[t].goals,a[e].newtotalwincount=parseInt(a[e].totalwincount)-this.state.analyticsstats[t].wins,a[e].newtotallosscount=parseInt(a[e].totallosscount)-this.state.analyticsstats[t].losses,a[e].newtotalmatchcount=parseInt(a[e].totalmatchcount)-this.state.analyticsstats[t].matches,a[e].newtotalassistcount=parseInt(a[e].totalassistcount)-this.state.analyticsstats[t].assists)}var s=[],n=0;for(e=0;e<a.length;e++)a[e].newtotalmatchcount&&a[e].newtotalmatchcount>0&&(s.push({auth:a[e].auth,lastname:a[e].lastname,totalplaytime:a[e].totalplaytime}),s[n].totalscorecount=a[e].newtotalscorecount,s[n].totalwincount=a[e].newtotalwincount,s[n].totallosscount=a[e].newtotallosscount,s[n].totalmatchcount=a[e].newtotalmatchcount,s[n].totalassistcount=a[e].newtotalassistcount,n+=1);console.log(s),console.log("---------------");var l=this.convertToLogDataStats(s);this.logStatsToFile(l),console.log(l)}},{key:"convertToLogDataStats",value:function(e){var a="";for(var t in e){for(var s in""!=a&&(a+="&"),a=a+"auth="+e[t].auth,e[t]){if("auth"!=s&&"jointime"!=s&&"isafk"!=s&&"scorecount"!=s&&"assistcount"!=s&&"heatmap"!=s)a+="&"+s.toLowerCase()+"="+e[t][s]}a+="&heatmap=0"}return a}},{key:"logStatsToFile",value:function(e){var a=new XMLHttpRequest;a.onreadystatechange=function(){a.readyState,XMLHttpRequest.DONE},a.open("POST","https://lively-scene-db1a.neinhold.workers.dev/?http://85.159.209.166.nip.io/data/stats.jsonl",!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.setRequestHeader("auth","AUTH"),a.setRequestHeader("type","STATS"),a.send(e)}},{key:"checkForKey",value:function(e,a){a in e||(e[a]={goals:0,assists:0,matches:0,wins:0,losses:0})}},{key:"checkForAuth",value:function(e,a){for(var t in this.state.analyticsstats)for(var s=0;s<this.state.analyticsstats[t].names.length;s++)if(this.state.analyticsstats[t].names[s]==a)return t;return null}},{key:"getReplayInfo",value:function(e){if(this.state.replayInfo)for(var a=0;a<this.state.replayInfo.length;a++){if(e==this.state.replayInfo[a].id)return this.state.replayInfo[a]}}},{key:"renderMessage",value:function(e){var a="",t="ChatMessage",s=new Date(parseInt(e.timeStamp)).toLocaleString();if(0==e.type&&(a+=e.name+": "),1==e.type&&(t="ChatMessageHost"),2==e.type&&(t="ChatAnnouncement"),3==e.type){t="ChatReplay",a="Replay Match #"+parseInt(e.id,10);var l=this.getReplayInfo(e.id);return n.a.createElement("div",null,n.a.createElement("div",{className:"ChatTimeStamp"},s),n.a.createElement("div",{className:t},a,l?D(l,-1,-1):n.a.createElement("div",null)))}return a+=e.message,n.a.createElement("div",null,n.a.createElement("div",{className:"ChatTimeStamp"},s),n.a.createElement("div",{className:t},a))}},{key:"render",value:function(){var e=this;return this.state.isHelp?n.a.createElement(M,null):n.a.createElement("div",{className:"ChatContainer"},this.state.chatLog.map((function(a,t){return e.renderMessage(a,t)})))}}]),t}(n.a.Component),M=function(e){Object(h.a)(t,e);var a=Object(p.a)(t);function t(e){var s;return Object(m.a)(this,t),(s=a.call(this,e)).state={commands:[]},s.state.commands=[{title:"afk",syntax:["i'm afk","im afk","set me afk"],info:"Sets you as away from keyboard, which prevents you from being assigned to a team."},{syntax:["set PLAYERNAME afk","PLAYERNAME is afk"],info:"Sets other player as afk.",admin:!0},{syntax:["i'm back","im back","back","not afk","no longer afk"],info:"Clears your afk status."},{title:"stats",syntax:["how long have i been playing","whats my playtime","for how long am i playing","how long has PLAYERNAME been playing"],info:"Prints your current and total playtime. \n If PLAYERNAME is specified, prints the values of the specified player."},{syntax:["how many goals","how often have i scored","whats my goal count","how many goals has PLAYERNAME scored"],info:"Prints your total amount of goals scored and your goals per game average. \n If PLAYERNAME is specified, prints the values of the specified player."},{syntax:["how many assists","assist count","how many assists does PLAYERNAME have"],info:"Prints your total amount of assists and your assists per game average. \n If PLAYERNAME is specified, prints the values of the specified player."},{syntax:["how many matches","how many games","match count","how often have i played","how many wins","how many games has PLAYERNAME played"],info:"Prints your total amount of games played and your winrate. \n If PLAYERNAME is specified, prints the values of the specified player."},{syntax:["how many own goals","how many own goals has PLAYERNAME scored"],info:"Prints your total amount of own goals and your own goals per game average. \n If PLAYERNAME is specified, prints the values of the specified player."},{syntax:["how many 1v1s","how many 1v1s has PLAYERNAME played"],info:"Prints your total amount of 1v1s played and your winrate. \n If PLAYERNAME is specified, prints the values of the specified player."},{syntax:["how many hattricks","how many hattricks has PLAYERNAME scored"],info:"Prints your total amount of hattricks as well as the amount of times you scored 4 or 5 goals in a single game. \n If PLAYERNAME is specified, prints the values of the specified player."},{syntax:["how often was i gk","how often was i keeper","how many times have i been gk","how many clean sheets","how often has PLAYERNAME been gk"],info:"Prints your total amount of games played as gk, as well as your goals conceded as gk and your number of clean sheets. \n If PLAYERNAME is specified, prints the values of the specified player."},{syntax:["how far have i run","what distance have i covered","how far has PLAYERNAME run"],info:"Prints your total distance covered, as well as your average distance covered per game. \n If PLAYERNAME is specified, prints the values of the specified player."},{syntax:["what is my rating","PLAYERNAME rating"],info:"Prints your overall, offense and defense rating. \n If PLAYERNAME is specified, prints the values of the specified player."},{syntax:["what is your prediction accuracy","how many predictions"],info:"Prints the amount of games NeinholdBot has predicted the result of, as well has his accuracy in predicting the winner and exact results."},{title:"maps",syntax:["change map to MAPNAME","switch map to MAPNAME","set map MAPNAME"],info:"Changes the map to any of the default maps. Only works when no game is underway.",admin:!0},{title:"auto modes",syntax:["auto mode","auto-mode","automode"],info:"Toggles auto mode, which will automatically assign players up to 4v4.",admin:!0},{syntax:["captains mode","captains-mode","captainsmode","captain mode"],info:"Toggles captains mode, which will assign a captain to each team and prompt them to pick players.",admin:!0},{syntax:["i want to be captain"],info:"Makes you eligible to be assigned as captain if you have been blacklisted. You are eligible by default."},{syntax:["unsuspend PLAYERNAME"],info:"Unsuspends the specified player if he is currently serving a suspension.",admin:!0},{title:"game modes and modifiers",syntax:["MODENAME"],info:"Enables the respective mode. Multiple modes can be active at once and will trigger in the order listed here.\n Values modified by modes are always overridden by their respective modifiers.\n\nmessiball: sets all playersizes to the value of MESSISIZE\nameriball: sets all playersizes to the value of AMERISIZE\ngkball: sets one player per team to AMERISIZE\nmixedball: sets one player per team to AMERISIZE and one to MESSISIZE\nrandomball: randomizes the size of each player\nbumpball: makes all players kickable, meaning you can press X to bump them around",admin:!0},{syntax:["set messisize to VALUE","set amerisize to VALUE"],info:"Changes the value of MESSISIZE or AMERISIZE, which define the player sizes in game modes. You shouldn't really change these values. They will not be reset when modifiers are reset.",admin:!0},{syntax:["MODIFIERNAME to VALUE","MODIFIERNAME VALUE"],info:"Sets the value of the respective modifier. Multiple modifiers can be set in a single command.\n\nballsize: sets the ballsize to an integer value. default is 10.\nplayersize: sets the size of each player to an integer value. default is 15.\ndamping: sets the damping of the ball to a float value that must lie between 0.0 and 1.0. a value of 1 means the ball will not lose momentum. default is 0.99.\nbounce: sets the bounce of the ball to a float value between 0.0 and 3.0. a value of 1 means the ball bounces off a surface with as much momentum as it hit that surface. default is 0.5.\nmass: sets the mass of the ball to a float value between 0.0 and 5.0. mass is inverse, so a higher value means a lighter ball and thus stronger kicks. default is 1.0.",admin:!0},{syntax:["reset"],info:"Resets all game modes and modifiers. If a game is underway you may need to stop it or score a goal in order for the default values to be applied.",admin:!0},{syntax:["what modifiers are active","tell me the current modifiers","what modes are active","what parameters have been changed"],info:"Prints a list of all currently active game modes and modifiers."},{syntax:["list modifiers","list modes","list parameters"],info:"Prints a list of all game modes and modifiers that can be set."},{title:"native command overrides",syntax:["!avatar AVATARSTRING","!avatar"],info:"This will set an animated avatar that is cycled through character by character (including spaces). This animated avatar is separate from the one set with the native /avatar command and will alternate with your normal avatar with a frequency of AVATARFREQUENCY."},{syntax:["!avatarfreq AVATARFREQUENCY"],info:"This will set the AVATARFREQUENCY in seconds which determines the interval in which your animated avatar is shown. For example, if you set this to 10, your normal avatar will be shown for 10 seconds before cycling through each character of your AVATARSTRING, then show your normal avatar for another 10 seconds and so on. Setting this to 0 means your normal avatar won't be shown at all. Default value is 4."},{syntax:["!colors TEAMNAME ANGLE TEXTCOLOR COLOR1 COLOR2 COLOR3"],info:"Sets the team colors just like the native /colors command does. Just replace the / with a !. Setting it this way allows for some animations (for example when a goal is scored), if they are enabled.",admin:!0}],s}return Object(u.a)(t,[{key:"renderSyntax",value:function(e,a){return n.a.createElement("div",{className:"CommandSyntax"},'"'+e+'"')}},{key:"renderCommand",value:function(e,a){var t=this,s="";e.title&&(s="CommandTitle");var l=n.a.createElement("div",null);return e.admin&&(l=n.a.createElement("div",{className:"Admin"},"Admins only")),n.a.createElement("div",{className:"CommandContainer"},n.a.createElement("div",{className:s},e.title),l,n.a.createElement("div",{className:"LeftTitle"},"Syntax:"),e.syntax.map((function(e,a){return t.renderSyntax(e,a)})),n.a.createElement("div",{className:"CommandInfo"},e.info))}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"ChatContainer"},n.a.createElement("div",{className:"BigDigit"},"Link"),n.a.createElement("hr",null),n.a.createElement("div",{className:"CommandContainer"},n.a.createElement("div",{className:"CommandInfo"},"The room link may sometimes change, as the server must be restarted in order for NeinholdBot to be updated. In that case, you can always find the latest link at"),n.a.createElement("a",{href:"https://neinhold.github.io"},n.a.createElement("div",{className:"CommandSyntax"},"neinhold.github.io")),n.a.createElement("div",{className:"CommandInfo"},n.a.createElement("br",null),"You can also simply go to"),n.a.createElement("a",{href:"https://neinhold.github.io/play"},n.a.createElement("div",{className:"CommandSyntax"},"neinhold.github.io/play")),n.a.createElement("div",{className:"CommandInfo"},"which will forward you to the latest room link automatically.")),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",{className:"BigDigit"},"Commands"),n.a.createElement("hr",null),n.a.createElement("div",{className:"CommandContainer"},n.a.createElement("div",{className:"CommandInfo"},"All commands (with the exception of native command overrides) must start with"),n.a.createElement("div",{className:"CommandSyntax"},"Hey NeinholdBot"),n.a.createElement("div",{className:"CommandInfo"},"The syntax after that is fairly forgiving and will accept different wording.",n.a.createElement("br",null),n.a.createElement("br",null),"If parameters like MAPNAME or MODIFIERNAME are specified, they must be an exact match of the target string. PLAYERNAME needs only be a unique match, see Captains mode section for an explanation of what that means.")),this.state.commands.map((function(a,t){return e.renderCommand(a,t)})),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",{className:"BigDigit"},"Captains mode for brainlets"),n.a.createElement("hr",null),n.a.createElement("div",{className:"CommandContainer"},n.a.createElement("div",{className:"CommandInfo"},"When you are assigned as captain of a team, you have several simple options to pick your team that are a much faster process than crying in chat about captains mode being active until an admin removes you from the game. These options are:"),n.a.createElement("div",{className:"CommandSyntax"},"Typing @"),n.a.createElement("div",{className:"CommandInfo"},"It literally doesn't get any more brainlet-proof than this. Type ",n.a.createElement("b",null,"@")," in the chatbox, and a list of all players will pop up. You can navigate that list with your arrow keys. Once you have selected a player you want to pick, press ",n.a.createElement("b",null,"TAB")," and then ",n.a.createElement("b",null,"ENTER")," to pick that player."),n.a.createElement("div",{className:"CommandSyntax"},"Typing the name of a player"),n.a.createElement("div",{className:"CommandInfo"},"Simple. This must not even be an exact match of the players name. Any string of a minimum length of 3 that is a substring of a single players name will be accepted.",n.a.createElement("br",null),"For example, if there is a player called ",n.a.createElement("b",null,"Abu Al-Britani")," and you simply type ",n.a.createElement("b",null,"abu")," in the chat, then unless there is another player whose name contains ",n.a.createElement("b",null,"abu")," in the room, ",n.a.createElement("b",null,"Abu Al-Britani")," will be picked."),n.a.createElement("div",{className:"CommandSyntax"},"Typing a number"),n.a.createElement("div",{className:"CommandInfo"},"Type the position of the player you want to pick in the spectator list."),n.a.createElement("div",{className:"CommandSyntax"},"Typing #"),n.a.createElement("div",{className:"CommandInfo"},"Works the same way ",n.a.createElement("b",null,"@")," does, except it uses player IDs instead of names."),n.a.createElement("div",{className:"CommandSyntax"},"Typing random"),n.a.createElement("div",{className:"CommandInfo"},"The zoomer option. This will automatically pick a team for you, you only need to type this once. However, typing ",n.a.createElement("b",null,"random")," will immediately blacklist you from being selected as captain in the future. You can undo that blacklisting by telling NeinholdBot, see commands above.")))}}]),t}(n.a.Component);function P(e){var a=e.split("\n");a=a.slice(0,a.length-1);for(var t=[],s=0;s<a.length;s++){var n=JSON.parse(a[s]);t.push(n)}return t}function L(e){var a=e,t=Math.floor(a/60);return t+"m"+parseInt(a-60*t)+"s"}function R(e){var a="000000000"+e;return a.substr(a.length-8)}function D(e,a,t){if("result"in e||(e.result=a+1),(-1!=e.result&&e.result<t||-1==t)&&e.result)return n.a.createElement(H,{replay:e,i:a})}var H=function(e){Object(h.a)(t,e);var a=Object(p.a)(t);function t(e){var s;return Object(m.a)(this,t),(s=a.call(this,e)).state={curTab:0,heatmaps:null,blueHeatMap:null,maxValue:1,isLoaded:!1},s}return Object(u.a)(t,[{key:"loadHeatmap",value:function(){var e=this,a=T+"heatmaps/replays/"+this.props.replay.id+".json";g.a.get(a).then((function(a){var t=[a.data];t=t[0];for(var s=[],n=1,l=0;l<t.length;l++){s.push({name:t[l].name,team:t[l].team,heatmap:[],visible:!0});for(var i=0;i<t[l].heatmap.length;i++)for(var r=0;r<t[l].heatmap[i].length;r++){var o=6.5*i,c=3.7666*r;2==t[l].team&&(o=6.5*(40-i),c=3.7666*(30-r));var m={x:o,y:c,value:t[l].heatmap[i][r]+1};s[l].heatmap.push(m),m.value>n&&(n=m.value)}}e.state.heatmaps=s,e.state.maxValue=n,e.setState({heatmaps:e.state.heatmaps})}))}},{key:"renderTabs",value:function(e){var a=this,t=["Tab","Tab"];return t[this.state.curTab]+=" Selected",e?n.a.createElement("div",null,n.a.createElement("div",{onClick:function(){return a.setState({curTab:0,isLoaded:!1})},className:t[0]},"Info"),n.a.createElement("div",{onClick:function(){return a.setState({curTab:1,isLoaded:!1})},className:t[1]},"Heatmap")):n.a.createElement("div",null)}},{key:"generateHeatMap",value:function(e){var a=this.props.replay.id,t=this.state.heatmaps[e].heatmap,s={".5":"rgb(232, 102, 102)",".8":"rgb(232, 60, 161)",".95":"rgb(255, 0, 234)"};2==this.state.heatmaps[e].team&&(s={".5":"rgb(32, 85, 153)",".8":"rgb(63, 218, 232)",".95":"rgb(0, 255, 191)"});var n={min:1,max:8,data:t};N.a.create({container:document.querySelector(".Heatmap"+a+"_"+e),radius:8,maxOpacity:.5,minOpacity:0,blur:.75,gradient:s}).setData(n)}},{key:"toggleHeatMap",value:function(e){var a=e,t=e+1,s=0;"red"!=e&&"blue"!=e||(a=0,t=this.state.heatmaps.length,s=1),"blue"==e&&(s=2);for(var n=null,l=a;l<t;l++)if(this.state.heatmaps[l].team==s||0==s){var i=document.querySelector(".Heatmap"+this.props.replay.id+"_"+l);null==n&&(n=i.style.visibility),"hidden"==n?(i.style.visibility="visible",this.state.heatmaps[l].visible=!0,this.setState({curTab:this.state.curTab})):(i.style.visibility="hidden",this.state.heatmaps[l].visible=!1,this.setState({curTab:this.state.curTab}))}}},{key:"renderHeatmap",value:function(e,a){return n.a.createElement("div",{className:"HeatmapContainer"},n.a.createElement("div",{style:{height:133},className:"Heatmap"+this.props.replay.id+"_"+a}))}},{key:"renderToggle",value:function(e,a){var t=this,s="#888888";if(this.state.heatmaps[a].visible&&(s="#FFFFFF"),this.state.heatmaps[a].team==e)return n.a.createElement("div",{style:{color:s},className:"TogglePlayer",onClick:function(){return t.toggleHeatMap(a)}},this.state.heatmaps[a].name)}},{key:"checkForGk",value:function(e){return"GK"in this.props.replay&&this.props.replay.gks.includes(e)?"(GK) "+e:e}},{key:"render",value:function(){var e=this,a="Container";-1==this.props.i&&(a="ContainerChat");var t=!1;if("Big"==this.props.replay.stadium&&(t=!0),0==this.state.curTab)return n.a.createElement("div",{className:a+" Click"},this.renderTabs(t),n.a.createElement("a",{href:I+this.props.replay.id+".hbr2",target:"_blank"},n.a.createElement("div",{className:"SmallDigitSmall"},parseInt(this.props.replay.id,10)),n.a.createElement("div",{className:"InfoPlainTitle"},L(this.props.replay.duration)),n.a.createElement("div",{className:"SubTitleOffset"},this.props.replay.stadium),function(e){if("No modifiers active"!=e.modifiers)return n.a.createElement("div",{className:"SubTitle"},e.modifiers)}(this.props.replay),n.a.createElement("div",{className:"PlayerStatsGames"},n.a.createElement("div",{className:"InfoBoxWide"},n.a.createElement("div",{className:"InfoPlainTitle"},"Red"),n.a.createElement("div",{className:"SmallDigit"},this.props.replay.scorered),n.a.createElement("hr",null)),n.a.createElement("div",{className:"InfoBoxWide"},n.a.createElement("div",{className:"InfoPlainTitle"},"Blue"),n.a.createElement("div",{className:"SmallDigit"},this.props.replay.scoreblue),n.a.createElement("hr",null)),n.a.createElement("div",{className:"PlayerStatsGames"},n.a.createElement("div",{className:"InfoBoxWide"},n.a.createElement("div",{className:"SubTitle"},this.props.replay.redplayers.map((function(e,a){return n.a.createElement("div",{className:"SubTitleOffset"},this.checkForGk(e))}),this))),n.a.createElement("div",{className:"InfoBoxWide"},n.a.createElement("div",{className:"SubTitle"},this.props.replay.blueplayers.map((function(e,a){return n.a.createElement("div",{className:"SubTitleOffset"},this.checkForGk(e))}),this)))))));if(null==this.state.heatmaps)this.loadHeatmap();else if(!this.state.isLoaded){var s=this;setTimeout((function(){for(var e=0;e<s.state.heatmaps.length;e++)s.generateHeatMap(e);s.state.isLoaded=!0}),500)}return null==this.state.heatmaps?n.a.createElement("div",{className:a+" Click"},this.renderTabs(t),n.a.createElement("div",{className:"Subtitle"},"No Heatmap available for this match.")):n.a.createElement("div",{className:a+" Click"},this.renderTabs(t),n.a.createElement("div",{className:"Heatmap"},n.a.createElement("img",{className:"Stadium",src:v.a}),this.state.heatmaps.map((function(a,t){return e.renderHeatmap(a,t)}))),n.a.createElement("div",{className:"Toggle",onClick:function(){return e.toggleHeatMap("red")}},"Toggle Red"),n.a.createElement("div",{className:"Toggle",onClick:function(){return e.toggleHeatMap("blue")}},"Toggle Blue"),n.a.createElement("div",null,n.a.createElement("div",{className:"ToggleContainer"},this.state.heatmaps.map((function(a,t){return e.renderToggle(1,t)}))),n.a.createElement("div",{className:"ToggleContainer"},this.state.heatmaps.map((function(a,t){return e.renderToggle(2,t)})))))}}]),t}(n.a.Component),O=Object(E.f)(A);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var F=t(21);i.a.render(n.a.createElement(F.a,null,n.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[41,1,2]]]);
//# sourceMappingURL=main.03fb0734.chunk.js.map